import json
import dask.dataframe as ddf

labels = ['adware', 'flooder', 'ransomware', 'dropper', 'spyware', 'packed', 'crypto_miner', 'file_infector', 'installer', 'worm', 'downloader']

df = ddf.read_parquet('/media/rodrigo/8a342967-3b50-4e7e-9ccc-f8383dde1662/data-science-bootstrap-datasciencebucket-1xmr1kwclu4qw/metadata/', compression='snappy')
for i, row in enumerate(df.iterrows()):
    if i == 10: break
    label_values = row[1][2:13].values
    metadata_values = list(row[1][13:13+2381].values)
    expected_labels = []
    for j, x in enumerate(label_values):
        if (x == 1): expected_labels.append(labels[j])
    with open(f'samples/{i}.json', 'w') as f:
        json.dump({"metadata": metadata_values,"expected": expected_labels}, f)
    
